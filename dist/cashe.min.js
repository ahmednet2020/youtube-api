'use strict';

var CACHE_NAME = 'v1.0.1';
var urlsToCache = ['./index.html', './css/main.min.css', './js/main.min.js'];
//install event
self.addEventListener('install', function (e) {
  // Perform install steps
  e.waitUntil(caches.open(CACHE_NAME).then(function (cache) {
    console.log('Opened cache');
    return cache.addAll(urlsToCache);
  }).then(function (cache) {
    return self.skipWaiting();
  }).catch(function (err) {
    console.log('open cashes erro: ' + err);
  }));
});
// active event
self.addEventListener('activate', function (e) {
  // delete any old caches
  e.waitUntil(caches.keys().then(function (keys) {
    return Promise.all(keys.map(function (key) {
      return key === CACHE_NAME ? key : caches.delete(key);
    }));
  }).then(function () {
    console.log('remove the old cashe done');
  }).catch(function () {
    console.log('remove old caches faild');
  }));
});
